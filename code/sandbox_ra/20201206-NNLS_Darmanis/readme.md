
Barebones implementation of 
nonnegative least squares (NNLS)
for 
cell type proportion inference.

The [bulk](../../../data/20201128-FGCZ)
and 
the [reference](../../../data/20201206-RefDatasets/2015-Darmanis)
datasets are first subset to the common genes.
The counts are normalized to sum=1.
The genes are again subset to a set of marker genes
(see [datasource.py](datasource.py)).

See [a_deconvolution0.py](a_deconvolution0.py)
for the minimal implementation
and the folder [a_deconvolution0](a_deconvolution0)
for the results.

To check the stability of the results
with respect to the reference dataset,
we performed multiple deconvolution runs of NNLS
where in each run a random subset of 50% 
of reference single cells was kept.
The following figures show the distribution
of the resulting cell type proportions.
The additional cross indicates the estimate 
from [MuSiC](https://numpde.github.io/sta426_deconvo/code/sandbox_ra/20201226-AllDeco/deconvolution.html).

This file was generated by [z_readme.py](z_readme.py). 


### Inferred cell types

#### A-10315_ALS_Ox_Female_56

<img src='a_deconvolution3/frac=0.5/A-10315_ALS_Ox_Female_56.png' width='360px'/>

#### A-11068_ALS_Ox_Female_70

<img src='a_deconvolution3/frac=0.5/A-11068_ALS_Ox_Female_70.png' width='360px'/>

#### A-15235_ALS_Ox_Male_63

<img src='a_deconvolution3/frac=0.5/A-15235_ALS_Ox_Male_63.png' width='360px'/>

#### A-26659_ALS_Ox_Male_82

<img src='a_deconvolution3/frac=0.5/A-26659_ALS_Ox_Male_82.png' width='360px'/>

#### A-26670_ALS_Ox_Male_50

<img src='a_deconvolution3/frac=0.5/A-26670_ALS_Ox_Male_50.png' width='360px'/>

#### A-26693_ALS_Ox_Female_68

<img src='a_deconvolution3/frac=0.5/A-26693_ALS_Ox_Female_68.png' width='360px'/>

#### A-28156_ALS_Ox_Male_69

<img src='a_deconvolution3/frac=0.5/A-28156_ALS_Ox_Male_69.png' width='360px'/>

#### A-28739_ALS_Ox_Male_68

<img src='a_deconvolution3/frac=0.5/A-28739_ALS_Ox_Male_68.png' width='360px'/>

#### A-29008_ALS_Ox_Male_67

<img src='a_deconvolution3/frac=0.5/A-29008_ALS_Ox_Male_67.png' width='360px'/>

#### A-29011_ALS_Ox_Female_68

<img src='a_deconvolution3/frac=0.5/A-29011_ALS_Ox_Female_68.png' width='360px'/>

#### A-29594_ALS_Ox_Male_65

<img src='a_deconvolution3/frac=0.5/A-29594_ALS_Ox_Male_65.png' width='360px'/>

#### A-29845_ALS_Ox_Female_60

<img src='a_deconvolution3/frac=0.5/A-29845_ALS_Ox_Female_60.png' width='360px'/>

#### A-32469_ALS_Ox_Male_71

<img src='a_deconvolution3/frac=0.5/A-32469_ALS_Ox_Male_71.png' width='360px'/>

#### A-32470_ALS_Ox_Male_54

<img src='a_deconvolution3/frac=0.5/A-32470_ALS_Ox_Male_54.png' width='360px'/>

#### A-32591_ALS_Ox_Male_82

<img src='a_deconvolution3/frac=0.5/A-32591_ALS_Ox_Male_82.png' width='360px'/>

#### B-04585_ALS_Lo_Male_44

<img src='a_deconvolution3/frac=0.5/B-04585_ALS_Lo_Male_44.png' width='360px'/>

#### B-06239_ALS_Lo_Female_44

<img src='a_deconvolution3/frac=0.5/B-06239_ALS_Lo_Female_44.png' width='360px'/>

#### B-06247_ALS_Lo_Male_61

<img src='a_deconvolution3/frac=0.5/B-06247_ALS_Lo_Male_61.png' width='360px'/>

#### B-06260_ALS_Lo_Male_72

<img src='a_deconvolution3/frac=0.5/B-06260_ALS_Lo_Male_72.png' width='360px'/>

#### B-06262_ALS_Lo_Female_70

<img src='a_deconvolution3/frac=0.5/B-06262_ALS_Lo_Female_70.png' width='360px'/>

#### B-06263_ALS_Lo_Male_82

<img src='a_deconvolution3/frac=0.5/B-06263_ALS_Lo_Male_82.png' width='360px'/>

#### B-06266_ALS_Lo_Female_65

<img src='a_deconvolution3/frac=0.5/B-06266_ALS_Lo_Female_65.png' width='360px'/>

#### B-06267_ALS_Lo_Male_68

<img src='a_deconvolution3/frac=0.5/B-06267_ALS_Lo_Male_68.png' width='360px'/>

#### B-06268_ALS_Lo_Male_78

<img src='a_deconvolution3/frac=0.5/B-06268_ALS_Lo_Male_78.png' width='360px'/>

#### B-06270_ALS_Lo_Female_83

<img src='a_deconvolution3/frac=0.5/B-06270_ALS_Lo_Female_83.png' width='360px'/>

#### B-06271_ALS_Lo_Male_50

<img src='a_deconvolution3/frac=0.5/B-06271_ALS_Lo_Male_50.png' width='360px'/>

#### B-06277_ALS_Lo_Male_65

<img src='a_deconvolution3/frac=0.5/B-06277_ALS_Lo_Male_65.png' width='360px'/>

#### B-06281_ALS_Lo_Female_63

<img src='a_deconvolution3/frac=0.5/B-06281_ALS_Lo_Female_63.png' width='360px'/>

#### B-06282_ALS_Lo_Female_65

<img src='a_deconvolution3/frac=0.5/B-06282_ALS_Lo_Female_65.png' width='360px'/>

#### B-06421_ALS_Lo_Male_75

<img src='a_deconvolution3/frac=0.5/B-06421_ALS_Lo_Male_75.png' width='360px'/>

#### B-10269_ALS_Lo_Male_45

<img src='a_deconvolution3/frac=0.5/B-10269_ALS_Lo_Male_45.png' width='360px'/>

#### B-10302_ALS_Lo_Male_62

<img src='a_deconvolution3/frac=0.5/B-10302_ALS_Lo_Male_62.png' width='360px'/>

#### B-10991_ALS_Lo_Male_75

<img src='a_deconvolution3/frac=0.5/B-10991_ALS_Lo_Male_75.png' width='360px'/>

#### B-15192_ALS_NB_Male_55

<img src='a_deconvolution3/frac=0.5/B-15192_ALS_NB_Male_55.png' width='360px'/>

#### B-15605_ALS_Lo_Male_75

<img src='a_deconvolution3/frac=0.5/B-15605_ALS_Lo_Male_75.png' width='360px'/>

#### B-16200_ALS_Lo_Male_74

<img src='a_deconvolution3/frac=0.5/B-16200_ALS_Lo_Male_74.png' width='360px'/>

#### B-16208_ALS_Lo_Male_66

<img src='a_deconvolution3/frac=0.5/B-16208_ALS_Lo_Male_66.png' width='360px'/>

#### B-20044_ALS_Lo_Male_68

<img src='a_deconvolution3/frac=0.5/B-20044_ALS_Lo_Male_68.png' width='360px'/>

#### B-28151_ALS_Lo_Male_60

<img src='a_deconvolution3/frac=0.5/B-28151_ALS_Lo_Male_60.png' width='360px'/>

#### B-28382_ALS_Lo_Male_75

<img src='a_deconvolution3/frac=0.5/B-28382_ALS_Lo_Male_75.png' width='360px'/>

#### B-28832_ALS_Lo_Female_68

<img src='a_deconvolution3/frac=0.5/B-28832_ALS_Lo_Female_68.png' width='360px'/>

#### B-28930_ALS_Lo_Male_66

<img src='a_deconvolution3/frac=0.5/B-28930_ALS_Lo_Male_66.png' width='360px'/>

#### B-30042_ALS_Lo_Female_72

<img src='a_deconvolution3/frac=0.5/B-30042_ALS_Lo_Female_72.png' width='360px'/>

#### C-03063_ALS_NB_Female_68

<img src='a_deconvolution3/frac=0.5/C-03063_ALS_NB_Female_68.png' width='360px'/>

#### C-11112_ALS_NB_Male_71

<img src='a_deconvolution3/frac=0.5/C-11112_ALS_NB_Male_71.png' width='360px'/>

#### C-12100_ALS_NB_Male_67

<img src='a_deconvolution3/frac=0.5/C-12100_ALS_NB_Male_67.png' width='360px'/>

#### C-12111_ALS_NB_Male_62

<img src='a_deconvolution3/frac=0.5/C-12111_ALS_NB_Male_62.png' width='360px'/>

#### C-15086_ALS_NB_Female_67

<img src='a_deconvolution3/frac=0.5/C-15086_ALS_NB_Female_67.png' width='360px'/>

#### C-16010_ALS_NB_Male_76

<img src='a_deconvolution3/frac=0.5/C-16010_ALS_NB_Male_76.png' width='360px'/>

#### C-16073_ALS_NB_Female_53

<img src='a_deconvolution3/frac=0.5/C-16073_ALS_NB_Female_53.png' width='360px'/>

#### C-16088_ALS_NB_Male_57

<img src='a_deconvolution3/frac=0.5/C-16088_ALS_NB_Male_57.png' width='360px'/>

#### C-99134_ALS_NB_Male_70

<img src='a_deconvolution3/frac=0.5/C-99134_ALS_NB_Male_70.png' width='360px'/>

#### E-02945_Control_Ox_Female_88

<img src='a_deconvolution3/frac=0.5/E-02945_Control_Ox_Female_88.png' width='360px'/>

#### E-02951_Control_Ox_Female_63

<img src='a_deconvolution3/frac=0.5/E-02951_Control_Ox_Female_63.png' width='360px'/>

#### E-10317_Control_Ox_Male_72

<img src='a_deconvolution3/frac=0.5/E-10317_Control_Ox_Male_72.png' width='360px'/>

#### E-10608_Control_Ox_Female_65

<img src='a_deconvolution3/frac=0.5/E-10608_Control_Ox_Female_65.png' width='360px'/>

#### E-11050_Control_Ox_Female_71

<img src='a_deconvolution3/frac=0.5/E-11050_Control_Ox_Female_71.png' width='360px'/>

#### E-11051_Control_Ox_Male_51

<img src='a_deconvolution3/frac=0.5/E-11051_Control_Ox_Male_51.png' width='360px'/>

#### E-11053_Control_Ox_Male_63

<img src='a_deconvolution3/frac=0.5/E-11053_Control_Ox_Male_63.png' width='360px'/>

#### E-19639_Control_Ox_Male_59

<img src='a_deconvolution3/frac=0.5/E-19639_Control_Ox_Male_59.png' width='360px'/>

#### E-19663_Control_Ox_Male_60

<img src='a_deconvolution3/frac=0.5/E-19663_Control_Ox_Male_60.png' width='360px'/>

#### E-24635_Control_Ox_Female_87

<img src='a_deconvolution3/frac=0.5/E-24635_Control_Ox_Female_87.png' width='360px'/>

#### F-10242_Control_Lo_Male_78

<img src='a_deconvolution3/frac=0.5/F-10242_Control_Lo_Male_78.png' width='360px'/>

#### F-15611_Control_Lo_Male_60

<img src='a_deconvolution3/frac=0.5/F-15611_Control_Lo_Male_60.png' width='360px'/>

#### F-15621_Control_Lo_Male_61

<img src='a_deconvolution3/frac=0.5/F-15621_Control_Lo_Male_61.png' width='360px'/>

#### F-15626_Control_Lo_Female_55

<img src='a_deconvolution3/frac=0.5/F-15626_Control_Lo_Female_55.png' width='360px'/>

#### F-15669_Control_Lo_Male_67

<img src='a_deconvolution3/frac=0.5/F-15669_Control_Lo_Male_67.png' width='360px'/>

#### F-16253_Control_Lo_Female_43

<img src='a_deconvolution3/frac=0.5/F-16253_Control_Lo_Female_43.png' width='360px'/>

#### F-16307_Control_Lo_Female_55

<img src='a_deconvolution3/frac=0.5/F-16307_Control_Lo_Female_55.png' width='360px'/>

#### F-16317_Control_Lo_Male_79

<img src='a_deconvolution3/frac=0.5/F-16317_Control_Lo_Male_79.png' width='360px'/>

#### F-21801_Control_Lo_Male_68

<img src='a_deconvolution3/frac=0.5/F-21801_Control_Lo_Male_68.png' width='360px'/>

#### F-30139_Control_Lo_Female_47

<img src='a_deconvolution3/frac=0.5/F-30139_Control_Lo_Female_47.png' width='360px'/>

#### F-30886_Control_Lo_Female_87

<img src='a_deconvolution3/frac=0.5/F-30886_Control_Lo_Female_87.png' width='360px'/>

#### F-32590_Control_Lo_Female_81

<img src='a_deconvolution3/frac=0.5/F-32590_Control_Lo_Female_81.png' width='360px'/>

#### G-10007_Control_NB_Female_85

<img src='a_deconvolution3/frac=0.5/G-10007_Control_NB_Female_85.png' width='360px'/>

#### G-11021_Control_NB_Female_85

<img src='a_deconvolution3/frac=0.5/G-11021_Control_NB_Female_85.png' width='360px'/>

#### G-11044_Control_NB_Male_51

<img src='a_deconvolution3/frac=0.5/G-11044_Control_NB_Male_51.png' width='360px'/>

#### G-11059_Control_NB_Female_84

<img src='a_deconvolution3/frac=0.5/G-11059_Control_NB_Female_84.png' width='360px'/>

#### G-11082_Control_NB_Female_84

<img src='a_deconvolution3/frac=0.5/G-11082_Control_NB_Female_84.png' width='360px'/>

#### G-11090_Control_NB_Female_85

<img src='a_deconvolution3/frac=0.5/G-11090_Control_NB_Female_85.png' width='360px'/>

#### G-11114_Control_NB_Female_81

<img src='a_deconvolution3/frac=0.5/G-11114_Control_NB_Female_81.png' width='360px'/>

#### G-12088_Control_NB_Female_85

<img src='a_deconvolution3/frac=0.5/G-12088_Control_NB_Female_85.png' width='360px'/>

#### G-15087_Control_NB_Female_75

<img src='a_deconvolution3/frac=0.5/G-15087_Control_NB_Female_75.png' width='360px'/>

#### H-0C046_Control_PD_Male_75

<img src='a_deconvolution3/frac=0.5/H-0C046_Control_PD_Male_75.png' width='360px'/>

#### H-0C048_Control_PD_Male_68

<img src='a_deconvolution3/frac=0.5/H-0C048_Control_PD_Male_68.png' width='360px'/>

#### H-0C064_Control_PD_Female_63

<img src='a_deconvolution3/frac=0.5/H-0C064_Control_PD_Female_63.png' width='360px'/>

#### H-0C072_Control_PD_Male_77

<img src='a_deconvolution3/frac=0.5/H-0C072_Control_PD_Male_77.png' width='360px'/>

#### H-0C083_Control_PD_Male_71

<img src='a_deconvolution3/frac=0.5/H-0C083_Control_PD_Male_71.png' width='360px'/>

#### H-0C084_Control_PD_Female_69

<img src='a_deconvolution3/frac=0.5/H-0C084_Control_PD_Female_69.png' width='360px'/>

#### H-0C085_Control_PD_Female_87

<img src='a_deconvolution3/frac=0.5/H-0C085_Control_PD_Female_87.png' width='360px'/>

#### H-0C096_Control_PD_Female_84

<img src='a_deconvolution3/frac=0.5/H-0C096_Control_PD_Female_84.png' width='360px'/>

#### H-0C730_Control_PD_Female_81

<img src='a_deconvolution3/frac=0.5/H-0C730_Control_PD_Female_81.png' width='360px'/>

#### H-DC005_Control_PD_Male_58

<img src='a_deconvolution3/frac=0.5/H-DC005_Control_PD_Male_58.png' width='360px'/>

#### H-DC022_Control_PD_Male_65

<img src='a_deconvolution3/frac=0.5/H-DC022_Control_PD_Male_65.png' width='360px'/>

#### H-DC023_Control_PD_Female_78

<img src='a_deconvolution3/frac=0.5/H-DC023_Control_PD_Female_78.png' width='360px'/>

#### H-DC027_Control_PD_Male_79

<img src='a_deconvolution3/frac=0.5/H-DC027_Control_PD_Male_79.png' width='360px'/>

#### H-DC029_Control_PD_Male_82

<img src='a_deconvolution3/frac=0.5/H-DC029_Control_PD_Male_82.png' width='360px'/>

#### H-DC040_Control_PD_Female_61

<img src='a_deconvolution3/frac=0.5/H-DC040_Control_PD_Female_61.png' width='360px'/>

#### H-DC092_Control_PD_Male_79

<img src='a_deconvolution3/frac=0.5/H-DC092_Control_PD_Male_79.png' width='360px'/>

#### H-DC107_Control_PD_Female_87

<img src='a_deconvolution3/frac=0.5/H-DC107_Control_PD_Female_87.png' width='360px'/>

#### H-DC110_Control_PD_Female_94

<img src='a_deconvolution3/frac=0.5/H-DC110_Control_PD_Female_94.png' width='360px'/>

#### H-DC112_Control_PD_Male_87

<img src='a_deconvolution3/frac=0.5/H-DC112_Control_PD_Male_87.png' width='360px'/>

